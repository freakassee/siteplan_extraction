include layout_extracted
block content
	#container
		#main_image
			img(src='/images/#{img_id}/transformed/#{img_id}.jpg' id='transformedImage')
		script(type='text/javascript').
			var scaleFactor;
			var scr_W 	= window.innerWidth;
			var scr_H 	= window.innerHeight;
			
			var trImg = document.getElementById('transformedImage');
			
			if(trImg.height / scr_H > trImg.width / scr_W){
				scaleFactor = trImg.height / scr_H;
				trImg.style.height = scr_H+'px';
			} else {
				scaleFactor = trImg.width / scr_W;
				trImg.style.width = scr_W+'px';
			}
			
			var main_div = document.getElementById('main_image');
			main_div.appendChild(trImg);
			
			
			var x_values = [#{x_values}];
			var y_values = [#{y_values}];
			var isSymbol_values = [#{isSymbol_values}];
			
			var extracted_W = x_values[1]-2*x_values[0];
			var extracted_H = y_values[11]-2*y_values[0];
			
			var extracted_W2 = x_values[1]-x_values[0];
			var extracted_H = y_values[11]-y_values[0];
			
			var ovr_W = roundDown(extracted_W/5/scaleFactor);
			var ovr_H = ovr_W;
	
			var ovr_list = [];
			for (var i = 0; i <  x_values.length; i++) {
				var ovr = document.createElement('img');
				ovr.setAttribute('src', '/styles/images/true.png');
				ovr.setAttribute('id','overlay_'+i+1);
				ovr.style.width=ovr_W+'px';

				ovr.style.position='absolute';
				ovr.style.left=(x_values[i]+extracted_W2)/scaleFactor+'px';
				ovr.style.top=(y_values[i]+extracted_H)/scaleFactor+'px';
				
				if(!isSymbol_values[i]){
					ovr.style.visibility='hidden';
				}
				
				main_div.appendChild(ovr);
				ovr_list[i]=ovr;
				
				
				function roundDown(number, decimals) {
				    decimals = decimals || 0;
				    return ( Math.floor( number * Math.pow(10, decimals) ) / Math.pow(10, decimals) );
				}
			}